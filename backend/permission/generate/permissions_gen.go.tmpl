// Code generated by github.com/cble-platform/cble-backend, DO NOT EDIT.

package permission

import (
	"context"

	"github.com/cble-platform/cble-backend/ent"
	"github.com/cble-platform/cble-backend/ent/grantedpermission"
	"github.com/cble-platform/cble-backend/permission/actions"
	"github.com/google/uuid"
)

var AllSubjectActions = map[grantedpermission.ObjectType][]actions.PermissionAction{
  {{- range $target, $actions := . }}
  grantedpermission.ObjectType{{- $target | Title -}}: {
    {{- range $actions.Content }}
    actions.Action{{- $target | Title -}}{{- .Value | Title }},
    {{- end }}
  },
  {{- end }}
}

{{- range $target, $actions := . }}
// {{ $target | Title }} //

{{ range $actions.Content }}
// Has{{- $target | Title -}}{{- .Value | Title }} reports whether a given user
{{- if ne .LineComment "" }} can {{ .LineComment | TrimCommentPrefix | ToLower }}
{{- else }} has the "{{- $target | ToLower -}}_{{- .Value | ToLower -}}" permission
{{- end }}. Use [github.com/google/uuid.Nil] to denote a wildcard object ID.
func Has{{- $target | Title -}}{{- .Value | Title -}}(ctx context.Context, client *ent.Client, entUser *ent.User, objectID uuid.UUID) (bool, error) {
	return HasPermission(
		ctx,
		client,
		entUser,
		grantedpermission.ObjectType{{- $target | Title -}},
		objectID,
		actions.Action{{- $target | Title -}}{{- .Value | Title -}},
	)
}

{{- end }}

{{ range $actions.Content }}
// CurrentUserHas{{- $target | Title -}}{{- .Value | Title }} reports whether the current user (pulled from context)
{{- if ne .LineComment "" }} can {{ .LineComment | TrimCommentPrefix | ToLower }}
{{- else }} has the "{{- $target | ToLower -}}_{{- .Value | ToLower -}}" permission
{{- end }}. Use [github.com/google/uuid.Nil] to denote a wildcard object ID.
func CurrentUserHas{{- $target | Title -}}{{- .Value | Title -}}(ctx context.Context, client *ent.Client, objectID uuid.UUID) (bool, error) {
	return CurrentUserHasPermission(
		ctx,
		client,
		grantedpermission.ObjectType{{- $target | Title -}},
		objectID,
		actions.Action{{- $target | Title -}}{{- .Value | Title -}},
	)
}

{{- end }}
{{- end }}
