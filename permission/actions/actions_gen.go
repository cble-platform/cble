// Code generated by github.com/cble-platform/cble-backend, DO NOT EDIT.

package actions

import (
	"encoding/json"
	"fmt"
	"io"
	"strings"

	"github.com/99designs/gqlgen/graphql"
)

type PermissionAction string

const (
	// -----------------------------------------------------------------
	// Group
	// -----------------------------------------------------------------

	// List all groups (only compatible with wildcard ID *)
	ActionGroupList PermissionAction = "group_list"
	// Create groups
	ActionGroupCreate PermissionAction = "group_create"
	// Get a given group
	ActionGroupGet PermissionAction = "group_get"
	// Update a given group
	ActionGroupUpdate PermissionAction = "group_update"
	// Delete a given group
	ActionGroupDelete PermissionAction = "group_delete"
	// -----------------------------------------------------------------
	// Permission
	// -----------------------------------------------------------------

	// List all permissions (only compatible with wildcard ID *)
	ActionPermissionList PermissionAction = "permission_list"
	// Get a given permission
	ActionPermissionGet PermissionAction = "permission_get"
	// Grant permissions (only compatible with wildcard ID *)
	ActionPermissionGrant PermissionAction = "permission_grant"
	// Revoke permissions (only compatible with wildcard ID *)
	ActionPermissionRevoke PermissionAction = "permission_revoke"
	// -----------------------------------------------------------------
	// Project
	// -----------------------------------------------------------------

	// List all projects (only compatible with wildcard ID *)
	ActionProjectList PermissionAction = "project_list"
	// Create projects (only compatible with wildcard ID *)
	ActionProjectCreate PermissionAction = "project_create"
	// Modify project memberships
	ActionProjectUpdateMembership PermissionAction = "project_update_membership"
	// Create blueprints in the project
	ActionProjectCreateBlueprints PermissionAction = "project_create_blueprints"
	// Update blueprints in the project
	ActionProjectUpdateBlueprints PermissionAction = "project_update_blueprints"
	// Delete blueprints in the project
	ActionProjectDeleteBlueprints PermissionAction = "project_delete_blueprints"
	// Deploy blueprints in the project
	ActionProjectDeployBlueprints PermissionAction = "project_deploy_blueprints"
	// -----------------------------------------------------------------
	// Provider
	// -----------------------------------------------------------------

	// List all providers (only compatible with wildcard ID *)
	ActionProviderList PermissionAction = "provider_list"
	// Create providers
	ActionProviderCreate PermissionAction = "provider_create"
	// Get a given provider
	ActionProviderGet PermissionAction = "provider_get"
	// Update a given provider
	ActionProviderUpdate PermissionAction = "provider_update"
	// Delete a given provider
	ActionProviderDelete PermissionAction = "provider_delete"
	// Load a given provider
	ActionProviderLoad PermissionAction = "provider_load"
	// Unload a given provider
	ActionProviderUnload PermissionAction = "provider_unload"
	// Configure a given provider
	ActionProviderConfigure PermissionAction = "provider_configure"
	// -----------------------------------------------------------------
	// User
	// -----------------------------------------------------------------

	// List all users (only compatible with wildcard ID *)
	ActionUserList PermissionAction = "user_list"
	// Create users
	ActionUserCreate PermissionAction = "user_create"
	// Get a given user
	ActionUserGet PermissionAction = "user_get"
	// Update a given user
	ActionUserUpdate PermissionAction = "user_update"
	// Delete a given user
	ActionUserDelete PermissionAction = "user_delete"
	// Returned for any potential errors
	ActionUnknown PermissionAction = "unknown"
)

// String strips the object-specific prefix from
func (p PermissionAction) DisplayString() string {
	if before, after, ok := strings.Cut(string(p), "_"); !ok {
		return before
	} else {
		return after
	}
}

var actionMap = map[string]map[string]PermissionAction{
	// Group
	"group": {
		"list":   ActionGroupList,
		"create": ActionGroupCreate,
		"get":    ActionGroupGet,
		"update": ActionGroupUpdate,
		"delete": ActionGroupDelete,
	},
	// Permission
	"permission": {
		"list":   ActionPermissionList,
		"get":    ActionPermissionGet,
		"grant":  ActionPermissionGrant,
		"revoke": ActionPermissionRevoke,
	},
	// Project
	"project": {
		"list":              ActionProjectList,
		"create":            ActionProjectCreate,
		"update_membership": ActionProjectUpdateMembership,
		"create_blueprints": ActionProjectCreateBlueprints,
		"update_blueprints": ActionProjectUpdateBlueprints,
		"delete_blueprints": ActionProjectDeleteBlueprints,
		"deploy_blueprints": ActionProjectDeployBlueprints,
	},
	// Provider
	"provider": {
		"list":      ActionProviderList,
		"create":    ActionProviderCreate,
		"get":       ActionProviderGet,
		"update":    ActionProviderUpdate,
		"delete":    ActionProviderDelete,
		"load":      ActionProviderLoad,
		"unload":    ActionProviderUnload,
		"configure": ActionProviderConfigure,
	},
	// User
	"user": {
		"list":   ActionUserList,
		"create": ActionUserCreate,
		"get":    ActionUserGet,
		"update": ActionUserUpdate,
		"delete": ActionUserDelete,
	},
}

// Returns a PermissionAction for a given object and action
func Get(object string, action string) PermissionAction {
	pa, ok := actionMap[strings.ToLower(object)][strings.ToLower(action)]
	if !ok {
		return ActionUnknown
	} else {
		return pa
	}
}

// Values provides list valid values for Enum.
func (PermissionAction) Values() (kinds []string) {
	for _, s := range []PermissionAction{
		ActionGroupList,
		ActionGroupCreate,
		ActionGroupGet,
		ActionGroupUpdate,
		ActionGroupDelete,
		ActionPermissionList,
		ActionPermissionGet,
		ActionPermissionGrant,
		ActionPermissionRevoke,
		ActionProjectList,
		ActionProjectCreate,
		ActionProjectUpdateMembership,
		ActionProjectCreateBlueprints,
		ActionProjectUpdateBlueprints,
		ActionProjectDeleteBlueprints,
		ActionProjectDeployBlueprints,
		ActionProviderList,
		ActionProviderCreate,
		ActionProviderGet,
		ActionProviderUpdate,
		ActionProviderDelete,
		ActionProviderLoad,
		ActionProviderUnload,
		ActionProviderConfigure,
		ActionUserList,
		ActionUserCreate,
		ActionUserGet,
		ActionUserUpdate,
		ActionUserDelete,
		ActionUnknown,
	} {
		kinds = append(kinds, string(s))
	}
	return
}

func MarshalPermissionAction(val PermissionAction) graphql.Marshaler {
	return graphql.WriterFunc(func(w io.Writer) {
		err := json.NewEncoder(w).Encode(val)
		if err != nil {
			panic(err)
		}
	})
}

func UnmarshalPermissionAction(v interface{}) (PermissionAction, error) {
	if m, ok := v.(string); ok {
		return PermissionAction(m), nil
	}

	return ActionUnknown, fmt.Errorf("%T is not a valid action", v)
}
